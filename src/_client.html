<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test</title>
    <div id="uid">uid: ---</div>
    <label for="name"><input type="text" id="name" name="name"></label>
    <label for="text"><input type="text" id="text" name="text"></label>
    <button id="send">送信</button>
    <div id="data"></div>
</head>
<body>
    <script>
        const ws = new WebSocket("ws://models-department.gl.at.ply.gg:14178");

        const uidElem = document.getElementById("uid");
        const name = document.getElementById("name");
        const text = document.getElementById("text");
        const send = document.getElementById("send");
        const output = document.getElementById("data");

        let uid;

        ws.onmessage = (message) => {
            const messageObject = JSON.parse(message.data);
            if (messageObject.type == 0) {
                uid = messageObject.id;
                uidElem.innerText = `uid: ${uid}`;
            } else {
                output.innerText += `${messageObject.name}#${messageObject.id} > ${messageObject.text}\n`
                console.log(`${messageObject.name}#${messageObject.id} > ${messageObject.text}`);
            }
        }

        send.addEventListener("click", () => {
            const data = { type: 1, id: uid, name: name.value, text: text.value }
            ws.send(JSON.stringify(data));
        })
    </script>
</body>
</html>